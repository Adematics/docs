(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{748:function(t,a,e){"use strict";e.r(a);var s=e(13),r=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"kestra-entreprise-edition"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kestra-entreprise-edition"}},[t._v("#")]),t._v(" Kestra Entreprise Edition")]),t._v(" "),e("h2",{attrs:{id:"secret-manager-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#secret-manager-configuration"}},[t._v("#")]),t._v(" Secret Manager configuration")]),t._v(" "),e("p",[t._v("Kestra add integration with secret manager. Secrets will be stored directly on secret backend and worker will read them at runtime only (in memory only).")]),t._v(" "),e("p",[t._v("Secret can be set using the user interface or with "),e("RouterLink",{attrs:{to:"/docs/terraform/resources/namespace_secret.html"}},[t._v("terraform")])],1),t._v(" "),e("p",[t._v("For now, we provide integration only for "),e("a",{attrs:{href:"https://www.vaultproject.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vault"),e("OutboundLink")],1),t._v(", but others will be added in the future.")]),t._v(" "),e("h3",{attrs:{id:"vault-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vault-configuration"}},[t._v("#")]),t._v(" Vault configuration")]),t._v(" "),e("p",[t._v("The integration will store secret in vault "),e("a",{attrs:{href:"https://www.vaultproject.io/docs/secrets/kv/kv-v2",target:"_blank",rel:"noopener noreferrer"}},[t._v("KV Secrets Engine - Version 2"),e("OutboundLink")],1),t._v(". Kestra authentications must have a full "),e("a",{attrs:{href:"https://www.vaultproject.io/docs/concepts/policies",target:"_blank",rel:"noopener noreferrer"}},[t._v("read & write policies"),e("OutboundLink")],1),t._v(" on this secrets store. You can optionally change "),e("code",[t._v("root-engine")]),t._v(" or "),e("code",[t._v("namespace")]),t._v(" (if you are using Vault Enterprise).")]),t._v(" "),e("h4",{attrs:{id:"authentication"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#authentication"}},[t._v("#")]),t._v(" Authentication")]),t._v(" "),e("h5",{attrs:{id:"password-authentification"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#password-authentification"}},[t._v("#")]),t._v(" Password authentification")]),t._v(" "),e("p",[t._v("We can use an "),e("a",{attrs:{href:"https://www.vaultproject.io/docs/auth/userpass",target:"_blank",rel:"noopener noreferrer"}},[t._v("Userpass Auth Method"),e("OutboundLink")],1),t._v(" using following configuration:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secret")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vault\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("vault")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhostt:8200"')]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" john\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" foo\n")])])]),e("h5",{attrs:{id:"token-authentification"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#token-authentification"}},[t._v("#")]),t._v(" Token authentification")]),t._v(" "),e("p",[t._v("We can use an "),e("a",{attrs:{href:"https://www.vaultproject.io/docs/auth/token",target:"_blank",rel:"noopener noreferrer"}},[t._v("Token Auth Method"),e("OutboundLink")],1),t._v(" using following configuration:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secret")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vault\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("vault")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhostt:8200"')]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("token")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("token")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" your"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("secret"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("token\n")])])]),e("h5",{attrs:{id:"approle-authentification"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#approle-authentification"}},[t._v("#")]),t._v(" AppRole authentification")]),t._v(" "),e("p",[t._v("We can use an "),e("a",{attrs:{href:"https://www.vaultproject.io/docs/auth/approle",target:"_blank",rel:"noopener noreferrer"}},[t._v("AppRole Auth Method"),e("OutboundLink")],1),t._v(" using following configuration:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secret")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vault\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("vault")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhostt:8200"')]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app-role")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approle\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("role-id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" your"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("role"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("id\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secret-id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" your"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("secret"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("id\n")])])]),e("h4",{attrs:{id:"others-configurations"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#others-configurations"}},[t._v("#")]),t._v(" Others configurations")]),t._v(" "),e("h5",{attrs:{id:"kestra-secret-vault-address"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kestra-secret-vault-address"}},[t._v("#")]),t._v(" "),e("code",[t._v("kestra.secret.vault.address")])]),t._v(" "),e("p",[t._v("The fully qualified address with scheme & port to your vault instance.")]),t._v(" "),e("h5",{attrs:{id:"kestra-secret-vault-namespace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kestra-secret-vault-namespace"}},[t._v("#")]),t._v(" "),e("code",[t._v("kestra.secret.vault.namespace")])]),t._v(" "),e("p",[t._v("Optional. Sets a global namespace to the Vault server instance. Namespace support requires "),e("a",{attrs:{href:"https://learn.hashicorp.com/vault/operations/namespaces",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vault Enterprise Pro"),e("OutboundLink")],1)]),t._v(" "),e("h5",{attrs:{id:"kestra-secret-vault-engine-version"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kestra-secret-vault-engine-version"}},[t._v("#")]),t._v(" "),e("code",[t._v("kestra.secret.vault.engine-version")])]),t._v(" "),e("p",[t._v("Optional. Sets the KV Secrets Engine version of the Vault server instance. Default is "),e("code",[t._v("2")])]),t._v(" "),e("h5",{attrs:{id:"kestra-secret-vault-root-engine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kestra-secret-vault-root-engine"}},[t._v("#")]),t._v(" "),e("code",[t._v("kestra.secret.vault.root-engine")])]),t._v(" "),e("p",[t._v("Optional. Sets the KV Secrets Engine of the Vault server instance. Default is "),e("code",[t._v("secret")])]),t._v(" "),e("h2",{attrs:{id:"worker-isolation-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#worker-isolation-configuration"}},[t._v("#")]),t._v(" Worker Isolation configuration")]),t._v(" "),e("p",[t._v("By default, Kestra use a "),e("a",{attrs:{href:"../../architecture#worker"}},[t._v("shared worker")]),t._v(" in order to handle workload. This is fine most of the case, but when you are using a shared Kestra instance between multiple team, since the worker is sharing the same file systems, this can allow people to access temporary files created by Kestra with powerful task like "),e("a",{attrs:{href:"/plugins/plugin-script-groovy/tasks/io.kestra.plugin.scripts.groovy.Eval"}},[t._v("Groovy")]),t._v(", "),e("a",{attrs:{href:"/plugins/plugin-script-jython/tasks/io.kestra.plugin.scripts.jython.Eval"}},[t._v("Jython")]),t._v("...")]),t._v(" "),e("p",[t._v("You can opt in to real isolation of file system using advanced Kestra EE java security :")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ee")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("java-security")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("forbidden-paths")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /etc/\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("authorized-class-prefix")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" io.kestra.core.tasks\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" io.kestra.plugin.gcp\n")])])]),e("h3",{attrs:{id:"kestra-ee-java-security-forbidden-paths"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kestra-ee-java-security-forbidden-paths"}},[t._v("#")]),t._v(" "),e("code",[t._v("kestra.ee.java-security.forbidden-paths")])]),t._v(" "),e("p",[t._v("Is filepath on the system that Kestra Worker will be forbidden to read or write all the time. This can be useful to protect Kestra configuration files for example.")]),t._v(" "),e("h3",{attrs:{id:"kestra-ee-java-security-authorized-class-prefix"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kestra-ee-java-security-authorized-class-prefix"}},[t._v("#")]),t._v(" "),e("code",[t._v("kestra.ee.java-security.authorized-class-prefix")])]),t._v(" "),e("p",[t._v("This security prevent access on file system or thread creation (that would prevent us to check file system access). Most of the plugins will never need to have file system access (except on temporary directory, that is created & isolated for a task, and is whitelist by default). Here you can set a list of prefix (namespace) class that will be allowed, all the other will be refused.")]),t._v(" "),e("p",[t._v("For example, "),e("RouterLink",{attrs:{to:"/plugins/plugin-gcp/"}},[t._v("GCP plugins")]),t._v(" will need to create thread in order to reach GCP api. Since this whole plugins is safe, you can white list it.")],1),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("At this time, all the Kestra official plugins is safe to be whitelisted "),e("strong",[t._v("except")]),t._v(" "),e("RouterLink",{attrs:{to:"/plugins/plugin-script-groovy/"}},[t._v("all scripts plugins")]),t._v(" since it allow to be create custom code that can read & write on file system. This one must not be added "),e("code",[t._v("authorized-class-prefix")])],1)]),t._v(" "),e("h2",{attrs:{id:"scripting-isolation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#scripting-isolation"}},[t._v("#")]),t._v(" Scripting isolation")]),t._v(" "),e("p",[t._v("For "),e("RouterLink",{attrs:{to:"/plugins/core/tasks/scripts/io.kestra.core.tasks.scripts.Bash.html"}},[t._v("Bash task")]),t._v(" & other scripts task in the core, we advised you to forced "),e("code",[t._v("DOCKER")]),t._v(" isolation and to configuration a global cluster "),e("RouterLink",{attrs:{to:"/docs/administrator-guide/configuration/others/#kestra-tasks-defaults"}},[t._v("taskDefaults")]),t._v(" :")],1),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tasks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("defaults")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" org.kestra.core.tasks.scripts.Bash\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("forced")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("values")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dockerOptions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runner")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" DOCKER\n")])])]),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("You will need to add all scripts plugins task (like Python & Node) to be sure that no task could by pass the docker isolation.")])])])}),[],!1,null,null,null);a.default=r.exports}}]);