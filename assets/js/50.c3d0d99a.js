(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{701:function(t,a,s){"use strict";s.r(a);var e=s(19),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"kafka-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka-configuration"}},[t._v("#")]),t._v(" Kafka configuration")]),t._v(" "),s("h2",{attrs:{id:"kestra-kafka-client-properties"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kestra-kafka-client-properties"}},[t._v("#")]),t._v(" "),s("code",[t._v("kestra.kafka.client.properties")])]),t._v(" "),s("p",[t._v("Most important configuration is to configure the way Kestra connect to Kafka cluster.")]),t._v(" "),s("p",[t._v("Here is a minimal configuration example :")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("client")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("bootstrap.servers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"localhost:9092"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("queue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka\n")])])]),s("p",[t._v("Here is another example with a secure kafka cluster hosted by "),s("a",{attrs:{href:"https://aiven.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("aiven"),s("OutboundLink")],1),t._v(":")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("client")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("bootstrap.servers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"your-host.aivencloud.com:12835"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("security.protocol")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SSL"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ssl.endpoint.identification.algorithm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ssl.key.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<your-password>"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ssl.keystore.location")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/etc/ssl/private/keystore.p12"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ssl.keystore.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<your-password>"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ssl.keystore.type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PKCS12"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ssl.truststore.location")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/etc/ssl/private/truststore.jks"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ssl.truststore.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<your-password>"')]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("queue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka\n")])])]),s("p",[s("code",[t._v("properties")]),t._v(" is the standard java kafka client properties, more details can be found "),s("a",{attrs:{href:"https://kafka.apache.org/documentation/",target:"_blank",rel:"noopener noreferrer"}},[t._v("on Kafka Documentation"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"kestra-kafka-defaults-topic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kestra-kafka-defaults-topic"}},[t._v("#")]),t._v(" "),s("code",[t._v("kestra.kafka.defaults.topic")])]),t._v(" "),s("p",[t._v("By default, Kestra automatically create all the topics needed, you can change partition & replication factor of these topics :")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("kestra.kafka.defaults.topic.partitions")]),t._v(": (default 16)")]),t._v(" "),s("li",[s("code",[t._v("kestra.kafka.defaults.topic.replication-factor")]),t._v(": (default 1)")])]),t._v(" "),s("h2",{attrs:{id:"kestra-kafka-defaults-consumer-producer-stream-properties"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kestra-kafka-defaults-consumer-producer-stream-properties"}},[t._v("#")]),t._v(" "),s("code",[t._v("kestra.kafka.defaults.[consumer|producer|stream].properties")])]),t._v(" "),s("p",[t._v("You can change the default properties of Kafka client from Kestra. These allow you to change compression, max request, etc...")]),t._v(" "),s("p",[t._v("Here is the default configuration :")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("defaults")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("consumer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("isolation.level")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read_committed"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("auto.offset.reset")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"earliest"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enable.auto.commit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"false"')]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("producer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("acks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("compression.type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lz4"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("max.request.size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10485760"')]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("stream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processing.guarantee")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exactly_once"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replication.factor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${kestra.kafka.defaults.topic.replication-factor}"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("acks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("compression.type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lz4"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("max.request.size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10485760"')]),t._v("\n")])])]),s("h2",{attrs:{id:"kestra-kafka-defaults-topics"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kestra-kafka-defaults-topics"}},[t._v("#")]),t._v(" "),s("code",[t._v("kestra.kafka.defaults.topics")])]),t._v(" "),s("p",[t._v("All the topic used by Kestra are declared with default name & properties. You can change the default values:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("kestra.kafka.defaults.topics."+t._s(t.topic)+".name")]),t._v(": Change the name of this topic.")]),t._v(" "),s("li",[s("code",[t._v("kestra.kafka.defaults.topics."+t._s(t.topic)+".properties")]),t._v(": Change the default properties used during topic automatic creation.")])]),t._v(" "),s("p",[t._v("You can see default configuration on this "),s("a",{attrs:{href:"https://github.com/kestra-io/kestra/blob/develop/cli/src/main/resources/application.yml",target:"_blank",rel:"noopener noreferrer"}},[t._v("file"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"kestra-kafka-defaults-consumer-prefix"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kestra-kafka-defaults-consumer-prefix"}},[t._v("#")]),t._v(" "),s("code",[t._v("kestra.kafka.defaults.consumer-prefix")])]),t._v(" "),s("p",[t._v("This configuration allow you to change the consumer-group prefix. By default, the prefix will be "),s("code",[t._v("kestra")]),t._v(".")]),t._v(" "),s("p",[t._v("For example, if you want to share a common Kafka cluster for the multiple instance of Kestra, just add another prefix like this :")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("defaults")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("consumer-prefix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uat_kestra"')]),t._v("\n")])])]),s("h2",{attrs:{id:"kestra-kafka-defaults-topic-prefix"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kestra-kafka-defaults-topic-prefix"}},[t._v("#")]),t._v(" "),s("code",[t._v("kestra.kafka.defaults.topic-prefix")])]),t._v(" "),s("p",[t._v("This configuration allow you to change the topic prefix. By default, the prefix will be "),s("code",[t._v("kestra_")]),t._v(".")]),t._v(" "),s("p",[t._v("For example, if you want to share a common Kafka cluster for the multiple instance of Kestra, just add another prefix like this :")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("defaults")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topic-prefix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uat_kestra"')]),t._v("\n")])])]),s("h2",{attrs:{id:"kestra-kafka-defaults-consumer-prefix-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kestra-kafka-defaults-consumer-prefix-2"}},[t._v("#")]),t._v(" "),s("code",[t._v("kestra.kafka.defaults.consumer-prefix")])]),t._v(" "),s("p",[t._v("This configuration allow you to enable log for all messages from or to Kafka. Use this one to debug all the messages consume, produce or both from Kafka.")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("This configuration have a huge performance impact, using regexp & serialization for most of the message")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kestra")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("client")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("loggers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("level")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" INFO "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mandatory: ERROR, WARN, INFO, DEBUG, TRACE, the logger must be configured at least at this level for class io.kestra.runner.kafka.AbstractInterceptor")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PRODUCER "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# optional: CONSUMER or PRODUCER")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topic-regexp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kestra_(executions|workertaskresult)"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# optional: a regexp validating the topic")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key-regexp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ."),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*parallel.*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# optional: a regexp validating the key")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value-regexp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ."),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*parallel.*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# optional: a regexp validating the json full body")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);